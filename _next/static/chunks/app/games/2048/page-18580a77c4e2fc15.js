(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[806],{9631:function(e,t,n){Promise.resolve().then(n.bind(n,5401))},9376:function(e,t,n){"use strict";var o=n(5475);n.o(o,"useRouter")&&n.d(t,{useRouter:function(){return o.useRouter}})},6225:function(e,t){"use strict";function n(){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5401:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var o=n(7437),i=n(2265),s=n(9376),r=n(6225),l=n.n(r);function a(){let e=(0,s.useRouter)(),[t,n]=(0,i.useState)([]),[r,a]=(0,i.useState)(0),[u,c]=(0,i.useState)(0),[d,f]=(0,i.useState)(!1),[h,p]=(0,i.useState)(null),[g,m]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=localStorage.getItem("2048_high_score");e&&c(parseInt(e)),x(),r>u&&(c(r),localStorage.setItem("2048_high_score",r.toString()))},[r]),(0,i.useEffect)(()=>{let e=e=>e.preventDefault();return document.addEventListener("touchmove",e,{passive:!1}),()=>document.removeEventListener("touchmove",e)},[]);let x=()=>{let e=[];v(e),v(e),n(e),a(0)},v=e=>{let t=[];for(let n=0;n<4;n++)for(let o=0;o<4;o++)e.some(e=>e.position[0]===n&&e.position[1]===o)||t.push([n,o]);if(t.length>0){let n=t[Math.floor(Math.random()*t.length)];e.push({value:.9>Math.random()?2:4,id:Date.now().toString(),position:n})}},b=e=>{n(t=>{let n=[...t],o=!1,i=r,s=(t,o)=>{switch(e){case"up":return n.filter(e=>e.position[1]===o).sort((e,t)=>e.position[0]-t.position[0]);case"down":return n.filter(e=>e.position[1]===o).sort((e,t)=>t.position[0]-e.position[0]);case"left":return n.filter(e=>e.position[0]===t).sort((e,t)=>e.position[1]-t.position[1]);case"right":return n.filter(e=>e.position[0]===t).sort((e,t)=>t.position[1]-e.position[1]);default:return[]}},l=e=>{let t=[],n=0;for(;n<e.length;)n+1<e.length&&e[n].value===e[n+1].value?(t.push({value:2*e[n].value,id:Date.now().toString(),position:e[n].position}),i+=2*e[n].value,n+=2,o=!0):(t.push(e[n]),n+=1);return t},a=(t,n,o)=>{let i=[],s=[];if("up"===e||"down"===e)for(let e=0;e<4;e++)s.push([e,o]);else for(let e=0;e<4;e++)s.push([n,e]);return t.forEach((e,t)=>{e.position=s[t],i.push(e)}),i};if("up"===e||"down"===e)for(let e=0;e<4;e++){let t=s(0,e);(t=a(t=l(t),0,e)).forEach(e=>{n.some(t=>t.id===e.id)||n.push(e)})}else for(let e=0;e<4;e++){let t=s(e,0);(t=a(t=l(t),e,0)).forEach(e=>{n.some(t=>t.id===e.id)||n.push(e)})}return o&&(v(n),(e=>{if(e.length<16)return!1;for(let t=0;t<4;t++)for(let n=0;n<4;n++){let o=e.find(e=>e.position[0]===t&&e.position[1]===n);if([e.find(e=>e.position[0]===t+1&&e.position[1]===n),e.find(e=>e.position[0]===t-1&&e.position[1]===n),e.find(e=>e.position[0]===t&&e.position[1]===n+1),e.find(e=>e.position[0]===t&&e.position[1]===n-1)].some(e=>(null==e?void 0:e.value)===(null==o?void 0:o.value)))return!1}return!0})(n)&&(alert("游戏结束！"),x())),n})},j=e=>{d&&h===e?(n(t=>t.filter(t=>t.id!==e)),p(null)):d&&p(e)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l(),{children:(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"})}),(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-orange-50 p-4",onTouchStart:e=>{let t=e.touches[0];m({x:t.clientX,y:t.clientY})},onTouchEnd:e=>{if(!g)return;let t=e.changedTouches[0],n=t.clientX-g.x,o=t.clientY-g.y;(Math.abs(n)>20||Math.abs(o)>20)&&(Math.abs(n)>Math.abs(o)?b(n>0?"right":"left"):b(o>0?"down":"up")),m(null)},children:(0,o.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)("button",{onClick:()=>e.back(),className:"text-gray-600 hover:text-gray-800 p-2 -ml-2",children:"← 返回"}),(0,o.jsxs)("div",{className:"text-right",children:[(0,o.jsxs)("div",{className:"text-sm text-gray-600",children:["最高分: ",u]}),(0,o.jsxs)("div",{className:"text-lg font-bold text-orange-600",children:["得分: ",r]})]})]}),(0,o.jsxs)("div",{className:"flex justify-between mb-4 gap-2",children:[(0,o.jsx)("button",{onClick:x,className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex-1",children:"重新开始"}),(0,o.jsx)("button",{onClick:()=>f(!d),className:"px-4 py-2 rounded-lg flex-1 ".concat(d?"bg-red-500 text-white":"bg-gray-200 text-gray-700"),children:d?"退出作弊":"作弊模式"})]}),(0,o.jsx)("div",{className:"bg-orange-100 p-4 rounded-xl",children:(0,o.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Array.from({length:16}).map((e,n)=>{let i=t.find(e=>e.position[0]===Math.floor(n/4)&&e.position[1]===n%4);return(0,o.jsx)("div",{onClick:()=>i&&j(i.id),className:"aspect-square rounded-lg flex items-center justify-center font-bold text-xl\n                      ".concat(i?"bg-orange-300":"bg-orange-200"," \n                      ").concat(d&&i&&h===i.id?"ring-2 ring-red-500":"","\n                      ").concat(d&&i?"cursor-pointer hover:opacity-90":""),children:null==i?void 0:i.value},n)})})}),(0,o.jsxs)("div",{className:"mt-4 text-sm text-gray-600 text-center",children:[(0,o.jsx)("p",{className:"mb-1",children:"滑动屏幕或使用方向键移动方块"}),d&&(0,o.jsx)("p",{className:"text-red-500",children:"点击方块两次删除它"})]})]})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=9631)}),_N_E=e.O()}]);