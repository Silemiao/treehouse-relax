(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[806],{361:function(e,t,n){Promise.resolve().then(n.bind(n,5401))},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},6225:function(e,t){"use strict";function n(){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5401:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7437),s=n(2265),l=n(9376),i=n(6225),o=n.n(i);let a=e=>{switch(e){case 2:return"bg-yellow-100 text-gray-700";case 4:return"bg-yellow-200 text-gray-700";case 8:return"bg-orange-300 text-white";case 16:return"bg-orange-400 text-white";case 32:return"bg-orange-500 text-white";case 64:return"bg-orange-600 text-white";case 128:return"bg-yellow-400 text-white";case 256:return"bg-yellow-500 text-white";case 512:return"bg-green-500 text-white";case 1024:return"bg-green-600 text-white";case 2048:return"bg-blue-600 text-white";default:return"bg-blue-700 text-white"}};function u(){let e=(0,l.useRouter)(),[t,n]=(0,s.useState)([]),[i,u]=(0,s.useState)(0),[c,d]=(0,s.useState)(0),[h,f]=(0,s.useState)(!1),[x,m]=(0,s.useState)(null),[g,p]=(0,s.useState)(null),[b,w]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=localStorage.getItem("2048_high_score");e&&d(parseInt(e)),v()},[]),(0,s.useEffect)(()=>{i>c&&(d(i),localStorage.setItem("2048_high_score",i.toString()))},[i,c]),(0,s.useEffect)(()=>{let e=e=>e.preventDefault();return document.addEventListener("touchmove",e,{passive:!1}),()=>document.removeEventListener("touchmove",e)},[]);let v=()=>{let e=[];j(e),j(e),n(e),u(0),w(!1),m(null)},j=e=>{let t=[];for(let n=0;n<4;n++)for(let r=0;r<4;r++)e.some(e=>e.position[0]===n&&e.position[1]===r)||t.push([n,r]);if(t.length>0){let n=t[Math.floor(Math.random()*t.length)];e.push({value:.9>Math.random()?2:4,id:Date.now().toString()+Math.random(),position:n})}},y=e=>{for(let t=0;t<4;t++)for(let n=0;n<4;n++)if(!e.some(e=>e.position[0]===t&&e.position[1]===n))return!1;for(let t=0;t<4;t++)for(let n=0;n<4;n++){let r=e.find(e=>e.position[0]===t&&e.position[1]===n);if(r){if(n<3){let s=e.find(e=>e.position[0]===t&&e.position[1]===n+1);if(s&&s.value===r.value)return!1}if(t<3){let s=e.find(e=>e.position[0]===t+1&&e.position[1]===n);if(s&&s.value===r.value)return!1}}}return!0};(0,s.useEffect)(()=>{let e=e=>{if(!b)switch(e.key){case"ArrowUp":N("up");break;case"ArrowDown":N("down");break;case"ArrowLeft":N("left");break;case"ArrowRight":N("right")}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[b]);let N=e=>{b||n(t=>{let n=[...t],r=!1,s=i,l=t=>"up"===e||"down"===e?n.filter(e=>e.position[1]===t).sort((t,n)=>"up"===e?t.position[0]-n.position[0]:n.position[0]-t.position[0]):n.filter(e=>e.position[0]===t).sort((t,n)=>"left"===e?t.position[1]-n.position[1]:n.position[1]-t.position[1]),o=e=>{let t=[],n=0;for(;n<e.length;)if(n+1<e.length&&e[n].value===e[n+1].value){let l=2*e[n].value;t.push({value:l,id:Date.now().toString()+Math.random(),position:e[n].position}),s+=l,n+=2,r=!0}else t.push(e[n]),n+=1;return t},a=(t,n)=>{let r=[];return t.forEach((t,s)=>{r.push({...t,position:"up"===e||"down"===e?["up"===e?s:3-s,n]:[n,"left"===e?s:3-s]})}),r};for(let e=0;e<4;e++){let t=l(e);if(t.length>0){let s=a(o(t),e);(n=n.filter(e=>!t.some(t=>t.id===e.id))).push(...s),t.length!==s.length&&(r=!0)}}return r&&(j(n),u(s),y(n)&&(w(!0),setTimeout(()=>{alert("游戏结束！最终得分：".concat(s))},100))),n})},k=e=>{h&&!b&&(x===e?(n(t=>{let n=t.find(t=>t.id===e);if(!n)return t;u(e=>Math.max(0,e-n.value));let r=t.filter(t=>t.id!==e);return 0===r.length?j(r):.3>Math.random()&&j(r),r}),m(null)):m(e))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o(),{children:[(0,r.jsx)("title",{children:"2048 - 树屋解压"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"})]}),(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-orange-50 p-4",onTouchStart:e=>{let t=e.touches[0];p({x:t.clientX,y:t.clientY})},onTouchEnd:e=>{if(!g)return;let t=e.changedTouches[0],n=t.clientX-g.x,r=t.clientY-g.y;(Math.abs(n)>50||Math.abs(r)>50)&&(Math.abs(n)>Math.abs(r)?N(n>0?"right":"left"):N(r>0?"down":"up")),p(null)},children:(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("button",{onClick:()=>e.back(),className:"text-gray-600 hover:text-gray-800 p-2 -ml-2",children:"← 返回"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["最高分: ",c]}),(0,r.jsxs)("div",{className:"text-lg font-bold text-orange-600",children:["得分: ",i]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between mb-4 gap-2",children:[(0,r.jsx)("button",{onClick:v,className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex-1",children:"重新开始"}),(0,r.jsx)("button",{onClick:()=>f(!h),className:"px-4 py-2 rounded-lg flex-1 ".concat(h?"bg-red-500 text-white":"bg-gray-200 text-gray-700"),children:h?"退出作弊":"作弊模式"})]}),(0,r.jsxs)("div",{className:"max-w-md mx-auto mb-4 flex justify-between items-center bg-white/80 backdrop-blur-sm rounded-xl p-4 shadow-md",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"当前分数"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-600",children:i})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"最高分数"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:c})]})]}),(0,r.jsx)("div",{className:"relative w-full max-w-md mx-auto aspect-square bg-white/80 backdrop-blur-sm rounded-xl p-2 mb-4 shadow-lg",children:t.map(e=>(0,r.jsx)("div",{className:"absolute w-1/4 h-1/4 p-1 transition-all duration-100 \n                  ".concat(h?"cursor-pointer hover:scale-105":"","\n                  ").concat(h&&x===e.id?"ring-2 ring-red-500":""),style:{transform:"translate(".concat(100*e.position[1],"%, ").concat(100*e.position[0],"%)")},onClick:()=>k(e.id),children:(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center\n                    rounded-lg text-2xl font-bold shadow-md\n                    ".concat(a(e.value),"\n                    transition-all duration-200 \n                    ").concat(h?"hover:opacity-75":""),children:e.value})},e.id))}),(0,r.jsx)("div",{className:"max-w-md mx-auto text-center text-gray-500 text-sm",children:b?(0,r.jsx)("p",{className:"text-red-500 font-bold",children:'游戏结束！点击"重新开始"继续游戏'}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"使用方向键或滑动屏幕移动方块"}),h&&(0,r.jsx)("p",{className:"mt-1 text-green-500",children:"点击方块两次将其消除"})]})})]})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=361)}),_N_E=e.O()}]);